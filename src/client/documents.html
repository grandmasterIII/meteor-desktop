<template name="pane_open">
  <div class="pane-open doc-dialog" name="{{name}}">
    {{>documents}}
    <div class="commands">
      {{call 'button' icon='folder-open' name='cmd_ok' text="Open"}}
      {{include 'upload_file' name='cmd_upload' icon='upload' text='Upload' accept=uploadtypes}}
      {{call 'button' icon='caret-left' name='cmd_cancel' text="Cancel"}}
    </div>
  </div>
</template>

<template name="pane_save">
  <div class="pane-save doc-dialog" name="{{name}}">
    {{>documents}}
    <div class="commands">
      {{call 'button' icon='save' name='cmd_ok' text="Save"}}
      {{call 'button' name='cmd_download' icon='download' text='Download'}}
      {{call 'button' icon='caret-left' name='cmd_cancel' text="Cancel"}}
    </div>
  </div>
</template>

<template name="pane_export">
  <div class="pane-export doc-dialog" name="{{name}}">
    {{>documents}}
    <div class="commands">
      {{call 'button' icon='externallink-alt' name='cmd_ok' text="Publish"}}
      {{call 'button' icon='caret-left' name='cmd_cancel' text="Cancel"}}
    </div>
  </div>
</template>


<template name="documents">
  <div class="documents">
    <div class="toolbar">
      <div class="heading">open document</div>
      {{call 'dropdown' name='type' value=state.type choices=typelist}}
      {{call 'input' name='title' choices=typelist}}
      <div class="parents">
        <div class="inner">
          {{#each parents}}<a data-path="{{fullpath}}">{{title}}<span class="sep">/</span></a>{{/each}}
        </div>
      </div>
    </div>
    <div class="list">
      {{#each docs}}
        <div class="document {{#if eq path ../state.selected}}selected{{/if}} {{#if isdir}}dir{{/if}}" data-docid="{{_id}}" data-path="{{path}}">
          <div class="info">
            {{#if isdir}}
              <i class="icon icon-folder-close"></i>
            {{else}}
              <i class="icon icon-file"></i>
            {{/if}}
              <span class="title">{{title}}</span>
              <span class="type">{{type}}</span>
          </div>
          {{#unless isdir}}
            {{>document_details}}
          {{/unless}}
        </div>
      {{/each}}
    </div>
  </div>
</template>
<template name="document_button">
  <i class="doc-button icon-{{icon}}"></i>
</template>

<template name="type_button">
  {{#if eq value active}}
    <button class="type-button active" data-type="{{value}}">{{label}}</button>
  {{else}}
    <button class="type-button" data-type="{{value}}">{{label}}</button>
  {{/if}}
</template>


<template name="document_details">
  <div class="details">
    {{#if neq owner currentUser.userId}}
      owned by 
      <span class="owner user">{{userName owner}}</span>
    {{/if}}
    {{#if eq cdate mdate}}
      created
      {{#if neq owner cuser}}
        by
        <span class="cuser user">{{userName cuser}}</span>
      {{/if}}
      <span class="cdate date">{{timec cdate}}</span>
    {{else}}
      last changed
      {{#if neq owner muser}}
        <span class="muser user">{{userName muser}}</span>
      {{/if}}
      on
      <span class="mdate date">{{timec mdate}}</span>
    {{/if}}
    <span class="size">({{size}} b, {{encoding}})</span>
  </div>
</template>
